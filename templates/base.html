<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="csrf-token" content="{{ csrf_token() }}" />
  <title>FCE Exam Trainer</title>
  <link rel="icon" href="{{ url_for('static', filename='favicon.svg') }}" type="image/svg+xml" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}?v=4" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script>
    (function() {
      if (localStorage.getItem('darkMode') === '1') document.documentElement.classList.add('dark-mode');
    })();
  </script>
</head>
<body data-current-part="{{ current_part }}">
  <header class="header">
    <div class="header-inner">
      <a href="{{ url_for('home') }}" class="logo logo-link">
        <span class="logo-icon" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 40" width="32" height="40" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M16 2 L28 8 L28 20 Q28 32 16 38 Q4 32 4 20 L4 8 Z" />
            <path d="M16 10 L16 28 M10 16 L22 16" stroke-linecap="round" />
          </svg>
        </span>
        <span class="logo-text"><strong>CAMBRIDGE</strong><br />English</span>
      </a>
      <div class="header-center">
        <span class="test-taker-label">Test taker ID</span>
        <span class="timer-display" id="timer">75:00</span>
        <button type="button" class="timer-btn" id="timer-toggle" title="Start/Pause">â–¶</button>
      </div>
      <div class="header-actions">
        <button type="button" class="dark-mode-btn" id="dark-mode-btn" title="Toggle dark mode" aria-label="Toggle dark mode">
          <span class="dark-mode-icon sun">â˜€</span>
          <span class="dark-mode-icon moon">ğŸŒ™</span>
        </button>
      </div>
    </div>
  </header>

  <main class="main">
    <div class="task-card">
      {% block content %}{% endblock %}
    </div>
  </main>

  <nav class="bottom-nav" aria-label="Exam navigation">
    <div class="bottom-nav-row parts-row">
      {% for p in range(1, 8) %}
      <a href="{{ url_for('use_of_english') }}?part={{ p }}" class="part-seg {{ 'done' if parts_done[p - 1] else '' }} {{ 'active' if current_part == p else '' }}" data-part="{{ p }}" data-total="{{ part_counts[p - 1] }}">
        <span class="part-seg-label">Part {{ p }}</span>
        {% if current_part == p %}
        <span class="part-seg-tasks part-seg-tasks-active" data-part="{{ p }}">
          {% for t in range(1, part_counts[p - 1] + 1) %}<span class="part-seg-task-num" data-task="{{ t }}">{{ t }}</span>{% endfor %}
        </span>
        <span class="part-seg-all-done" aria-hidden="true" style="display: none;">âœ“</span>
        {% else %}
        <span class="part-seg-summary">1-{{ part_counts[p - 1] }}</span>
        {% if parts_done[p - 1] %}<span class="part-seg-check" aria-hidden="true">âœ“</span>{% endif %}
        {% endif %}
      </a>
      {% endfor %}
    </div>
    <div class="bottom-nav-row controls-row">
      <div class="nav-arrows">
        <a href="{{ url_for('use_of_english') }}?part={{ current_part - 1 if current_part > 1 else 7 }}" class="nav-arrow" id="nav-prev" title="Previous part">â†</a>
        <a href="{{ url_for('use_of_english') }}?part={{ current_part + 1 if current_part < 7 else 1 }}" class="nav-arrow" id="nav-next" title="Next part">â†’</a>
      </div>
      <a href="#" class="btn-submit" id="btn-submit-link"><span class="btn-submit-icon">âœ“</span> Submit</a>
    </div>
  </nav>

  <script src="{{ url_for('static', filename='main.js') }}?v=4"></script>
</body>
</html>
